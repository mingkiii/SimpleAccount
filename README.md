# 💸 SimpleAccount System
Account(계좌) 시스템은 사용자와 계좌의 정보를 저장하고 있으며, 외부 시스템에서 거래를 요청할 경우 거래 정보를 받아서 계좌에서 잔액을 거래금액만큼 줄이거나(결제), 거래금액만큼 늘리는(결제 취소) 거래 관리 기능을 제공하는 시스템입니다.

- 구현의 편의를 위해 사용자 생성 등의 관리는 API로 제공하지 않고 프로젝트 시작 시 자동으로 데이터가 입력되도록 하며, 계좌 추가/해지/확인, 거래 생성/거래 취소/거래 확인의 6가지 API를 제공한다.
* 거래금액을 늘리거나 줄이는 과정에서 여러 쓰레드 혹은 인스턴스에서 같은 계좌에 접근할 경우 동시성 이슈로 인한 lost update가 발생할 수 있으므로 이 부분을 해결해야만 한다.

## ⚙️ Tech Stack

- Intellij IDA(ultimate)
- java, Spring boot, Spring data jpa, Embedded redis
- DB : H2 DB(memory DB 모드)
-----------
## 📋 Process

### 1. 계좌 관련 API(Account)

1) 계좌 생성 (사용자 아이디, 초기 잔액)
  - 결과 : 
    - 성공 -> 계좌번호 10자리 랜덤 숫자, response (사용자 아이디, 계좌번호, 등록일시)
    - 실패 <- 사용자가 없는 경우, (사용자당 최대 보유 가능 계좌 수 : 10개)계좌가 10개를 넘어가는 경우

2) 계좌 해지 (사용자 아이디, 계좌 번호)
  - 결과 :
    - 성공 -> response (사용자 아이디, 계좌번호, 해지일시)
    - 실패 <- 사용자 없는 경우, 사용자 아이디와 계좌 소유주가 다른 경우, 계좌가 이미 해지 상태인 경우, 잔액이 있는 경우
    
3) 계좌 조회 (사용자 아이디)
  - 결과 : 
    - 성공 -> response (계좌번호, 잔액) 정보를 Json list 형식으로
    - 실패 <- 사용자 없는 경우

### 2. 거래 관련 API(Transaction)

1) 잔액 사용 (사용자 아이디, 계좌 번호, 거래 금액)
  - 결과 :
    - 성공 -> response (계좌번호, transaction_result, transaction_id, 거래금액, 거래일시)
    - 실패 <- 사용자 없는 경우, 사용자 아이디와 계좌 소유주가 다른 경우, 계좌가 이미 해지 상태인 경우, 거래금액이 잔액보다 큰 경우, 거래금액이 너무 작거나 큰 경우

2) 잔액 사용 취소 (transaction_id, 계좌번호, 거래금액)
- 결과 :
    - 성공 -> response (계좌번호, transaction_result, transaction_id, 취소 거래금액, 거래일시)
    - 실패 <- 원거래 금액과 취소 금액이 다른 경우, 트랜잭션이 해당 계좌의 거래가 아닌경우

3) 거래 조회 (transaction_id)
- 결과 :
    - 성공 -> response (계좌번호, 거래종류(잔액 사용, 잔액 사용 취소), transaction_result(실패한 거래도 확인 가능하도록), transaction_id, 거래금액, 거래일시)
    - 실패 <- 해당 transaction_id 없는 경우

---------
